<!DOCTYPE html><html lang="en"><head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Flat Cake â€” Candles</title>
  <link rel="stylesheet" href="/cake.e9ba3050.css">
  <style>.wish-popup {
  backdrop-filter: blur(3px);
  z-index: 99999;
  opacity: 0;
  pointer-events: none;
  background: #1108162e;
  justify-content: center;
  align-items: center;
  transition: opacity .26s;
  display: flex;
  position: fixed;
  inset: 0;
}

.wish-popup.show {
  opacity: 1;
  pointer-events: auto;
}

.wish-box {
  text-align: center;
  background: linear-gradient(#fff7fb, #fff0f5);
  border: 3px solid #ff6f9114;
  border-radius: 16px;
  min-width: 260px;
  max-width: 88%;
  padding: 22px 28px;
  animation: .32s cubic-bezier(.2, .9, .2, 1) forwards popWish;
  box-shadow: 0 20px 60px #1808202e;
}

.wish-box h2 {
  color: #ff6f91;
  margin: 0 0 6px;
  font-family: Lobster, cursive;
  font-size: 22px;
}

.wish-box p {
  color: #6f2f3e;
  margin: 0 0 14px;
  font-size: 15px;
  line-height: 1.3;
}

.wish-box .ok-btn {
  appearance: none;
  color: #fff;
  cursor: pointer;
  background: linear-gradient(90deg, #ffb3c8, #ff8aa1);
  border: none;
  border-radius: 999px;
  padding: 8px 14px;
  font-weight: 600;
  box-shadow: 0 8px 22px #ff6f9124;
}

@keyframes popWish {
  0% {
    opacity: 0;
    transform: scale(.7);
  }

  60% {
    opacity: 1;
    transform: scale(1.06);
  }

  100% {
    opacity: 1;
    transform: scale(1);
  }
}

@media (width <= 420px) {
  .wish-box {
    padding: 18px 20px;
  }

  .wish-box h2 {
    font-size: 20px;
  }

  .wish-box p {
    font-size: 14px;
  }
}
</style>
</head>
<body>
  <main class="page">
    <section class="card" aria-labelledby="title">
      <h1 id="title" class="title">Make a Wish</h1>

      <div class="bg-deco" aria-hidden="true"></div>

      <div class="controls-top">
        <label for="candleCount">Candles</label>
        <div class="candle-controls">
          <button id="decCand">âˆ’</button>
          <input id="candleCount" type="range" min="1" max="12" value="3">
          <button id="incCand">+</button>
          <span id="candleLabel">3</span>
        </div>
      </div>

      <div class="cake-wrap" id="cakeWrap" tabindex="0" role="region" aria-label="Cake with candles">
        <svg viewBox="0 0 520 360" class="cake-svg" xmlns="http://www.w3.org/2000/svg" role="img" aria-hidden="false">
          <!-- plate -->
          <ellipse cx="260" cy="320" rx="180" ry="18" fill="#efe9f1"></ellipse>

          <!-- bottom shadow under cake -->
          <ellipse cx="260" cy="280" rx="160" ry="28" fill="rgba(235, 200, 220, 0.08)"></ellipse>

          <!-- bottom layer -->
          <g id="layer-bottom" transform="translate(60,140)">
            <rect x="0" y="0" width="400" height="120" rx="20" fill="#ffdbe6"></rect>
            <path class="drip" d="M0 22c36-18 72 8 120 8s36-26 88-14 88 28 132 12 60-18 60-18v92H0z" fill="#ffeef4"></path>
            <rect x="0" y="98" width="400" height="14" rx="7" fill="#ff9fb8"></rect>
            <g fill="#ffffff" opacity="0.9">
              <rect x="80" y="38" width="6" height="2" rx="1" transform="rotate(-18 80 38)"></rect>
              <rect x="160" y="64" width="6" height="2" rx="1" transform="rotate(12 160 64)"></rect>
              <rect x="240" y="48" width="6" height="2" rx="1" transform="rotate(-28 240 48)"></rect>
              <rect x="320" y="56" width="6" height="2" rx="1" transform="rotate(14 320 56)"></rect>
            </g>
          </g>

          <!-- middle tier (short) -->
          <g id="layer-mid" transform="translate(120,100)">
            <rect x="0" y="0" width="280" height="56" rx="12" fill="#ffe6ef"></rect>
            <rect x="0" y="44" width="280" height="6" rx="3" fill="#ffb1c7"></rect>
          </g>

          <!-- top cushion -->
          <g id="top-pill" transform="translate(160,64)">
            <rect x="0" y="0" width="200" height="44" rx="12" fill="#ffdfea"></rect>
            <rect x="18" y="24" width="164" height="6" rx="3" fill="#ff9fb8"></rect>
          </g>

          <!-- candles container (dynamic) -->
          <g id="candles" transform="translate(0,0)"></g>

          <!-- confetti / sparklers -->
          <g id="confetti"></g>
        </svg>
      </div>

      <div class="controls">
        <button id="blowBtn">Blow out</button>
        <button id="makeAWish">Make a wish âœ¨</button>
        <button id="relightAll" class="secondary">Relight all</button>
      </div>

    </section>
  </main>

  <!-- Wish popup inserted directly in this file -->
  <div id="wishPopup" class="wish-popup" role="dialog" aria-hidden="true" aria-modal="true" aria-labelledby="wishTitle">
    <div class="wish-box" role="document">
      <h2 id="wishTitle">ðŸŽ€ Make a Wish</h2>
      <p id="wishMsg">May all your wishes come true â€” may today be full of love and magic ðŸ’–</p>
      <div style="justify-content: center; display: flex">
        <button id="closeWish" class="ok-btn" aria-label="Close wish popup">Okay ðŸ’—</button>
      </div>
    </div>
  </div>

  <script>/* cake.js (plain JS equivalent of your cake.ts) */ (function() {
    const cakeWrap = document.getElementById('cakeWrap');
    const blowBtn = document.getElementById('blowBtn');
    const makeAWishBtn = document.getElementById('makeAWish');
    const relightAllBtn = document.getElementById('relightAll');
    const candlesContainer = document.getElementById('candles');
    const confettiGroup = document.getElementById('confetti');
    const range = document.getElementById('candleCount');
    const label = document.getElementById('candleLabel');
    const incBtn = document.getElementById('incCand');
    const decBtn = document.getElementById('decCand');
    let candleCount = Math.max(1, Math.min(12, Number(range.value || 3)));
    let candlesOn = [];
    let rafHandles = [];
    const rand = function(min, max) {
        return Math.random() * (max - min) + min;
    };
    function createCandleSVG(index, x, yBase) {
        var ns = 'http://www.w3.org/2000/svg';
        var g = document.createElementNS(ns, 'g');
        g.setAttribute('class', 'candle');
        g.setAttribute('data-index', String(index));
        g.setAttribute('transform', 'translate(' + x + ', ' + yBase + ')');
        var rect = document.createElementNS(ns, 'rect');
        rect.setAttribute('x', '-6');
        rect.setAttribute('y', '-62');
        rect.setAttribute('width', '12');
        rect.setAttribute('height', '50');
        rect.setAttribute('rx', '3');
        rect.setAttribute('fill', '#ff9aa8');
        var path = document.createElementNS(ns, 'path');
        path.setAttribute('d', index % 2 === 0 ? 'M-3 -68 q6 8 0 18' : 'M6 -68 q-6 8 0 18');
        path.setAttribute('stroke', index % 3 === 0 ? '#ff9aa8' : index % 3 === 1 ? '#8fcfff' : '#ffd46b');
        path.setAttribute('stroke-width', '2');
        path.setAttribute('fill', 'none');
        var fw = document.createElementNS(ns, 'g');
        fw.setAttribute('class', 'flameWrap');
        fw.setAttribute('transform', 'translate(0,-82)');
        var glow = document.createElementNS(ns, 'ellipse');
        glow.setAttribute('class', 'flameGlow');
        glow.setAttribute('cx', '0');
        glow.setAttribute('cy', '-2');
        glow.setAttribute('rx', String(10 + index % 2));
        glow.setAttribute('ry', String(14 + index % 2));
        glow.setAttribute('opacity', '0.18');
        glow.setAttribute('fill', '#fff2b8');
        var flame = document.createElementNS(ns, 'path');
        flame.setAttribute('class', 'flame');
        flame.setAttribute('d', 'M0 0 C4 -8 4 -16 0 -22 C-4 -16 -4 -8 0 0 Z');
        flame.setAttribute('fill', '#ffd06b');
        fw.appendChild(glow);
        fw.appendChild(flame);
        g.appendChild(rect);
        g.appendChild(path);
        g.appendChild(fw);
        g.addEventListener('click', function(ev) {
            ev.stopPropagation();
            var idx = Number(g.getAttribute('data-index'));
            toggleCandle(idx);
        });
        return g;
    }
    function renderCandles(count) {
        candlesContainer.innerHTML = '';
        candlesOn = [];
        var centerX = 260;
        var width = 200;
        var yBase = 90;
        var n = Math.max(1, Math.min(12, count));
        var step = width / n;
        for(var i = 0; i < n; i++){
            var x = centerX - width / 2 + step / 2 + i * step;
            var g = createCandleSVG(i, x, yBase);
            candlesContainer.appendChild(g);
            candlesOn.push(true);
        }
        candleCount = n;
        if (range) range.value = String(n);
        if (label) label.textContent = String(n);
        refreshWrapClass();
        startFlickers();
    }
    function startFlickers() {
        stopFlickers();
        var candleGroups = Array.from(candlesContainer.querySelectorAll('.candle'));
        candleGroups.forEach(function(el, idx) {
            var flame = el.querySelector('.flame');
            var glow = el.querySelector('.flameGlow');
            var t = rand(0, 1000);
            (function frame() {
                if (!candlesOn[idx]) return;
                var s = 1 + Math.sin(t * 0.07 + idx) * 0.03 + Math.random() * 0.04;
                var rot = Math.sin(t * 0.03 + idx) * 3 + rand(-1, 1);
                if (flame) flame.style.transform = 'scale(' + s + ') rotate(' + rot + 'deg)';
                if (glow) glow.style.transform = 'scale(' + (1 + (s - 1) * 1.3) + ')';
                if (flame) flame.style.opacity = (0.85 + Math.abs(Math.sin(t * 0.04)) * 0.15).toString();
                t += 1;
                rafHandles[idx] = requestAnimationFrame(frame);
            })();
        });
    }
    function stopFlickers() {
        rafHandles.forEach(function(id) {
            cancelAnimationFrame(id);
        });
        rafHandles = [];
        var candleGroups = Array.from(candlesContainer.querySelectorAll('.candle'));
        candleGroups.forEach(function(el) {
            var flame = el.querySelector('.flame');
            var glow = el.querySelector('.flameGlow');
            if (flame) {
                flame.style.transform = 'scale(0.25)';
                flame.style.opacity = '0';
            }
            if (glow) {
                glow.style.transform = 'scale(0.25)';
                glow.style.opacity = '0';
            }
        });
    }
    function refreshWrapClass() {
        var anyOn = candlesOn.some(Boolean);
        if (cakeWrap) {
            cakeWrap.classList.toggle('candle-on', anyOn);
            cakeWrap.classList.toggle('candle-out', !anyOn);
        }
    }
    function toggleCandle(idx, setTo) {
        if (idx < 0 || idx >= candlesOn.length) return;
        candlesOn[idx] = typeof setTo === 'boolean' ? setTo : !candlesOn[idx];
        var group = candlesContainer.querySelector('.candle[data-index="' + idx + '"]');
        if (!group) return;
        var flame = group.querySelector('.flame');
        var glow = group.querySelector('.flameGlow');
        if (candlesOn[idx]) {
            if (flame) flame.style.opacity = '1';
            if (glow) glow.style.opacity = '0.18';
        } else {
            if (flame) flame.style.opacity = '0';
            if (glow) glow.style.opacity = '0';
            // small puff
            var ns = 'http://www.w3.org/2000/svg';
            var puff = document.createElementNS(ns, 'circle');
            puff.setAttribute('cx', '0');
            puff.setAttribute('cy', String(-94));
            puff.setAttribute('r', '6');
            puff.setAttribute('fill', '#e9f0ff');
            puff.style.transition = 'transform 700ms ease, opacity 700ms ease';
            confettiGroup.appendChild(puff);
            setTimeout(function() {
                puff.style.transform = 'translate(' + rand(-30, 30) + 'px, ' + rand(-120, -40) + 'px) scale(0.2)';
                puff.style.opacity = '0';
            }, 20);
            setTimeout(function() {
                if (puff.parentNode) puff.parentNode.removeChild(puff);
            }, 900);
        }
        refreshWrapClass();
        if (candlesOn.some(Boolean)) startFlickers();
        else stopFlickers();
    }
    function blowOutAll() {
        for(var i = 0; i < candlesOn.length; i++)toggleCandle(i, false);
        spawnConfetti(18);
    }
    function relightAll() {
        for(var i = 0; i < candlesOn.length; i++)toggleCandle(i, true);
        startFlickers();
    }
    function spawnConfetti(count) {
        for(var i = 0; i < count; i++){
            var kind = Math.random() > 0.5 ? 'rect' : 'circle';
            var ns = 'http://www.w3.org/2000/svg';
            var el = document.createElementNS(ns, kind === 'rect' ? 'rect' : 'circle');
            var x = rand(180, 340);
            var y = rand(10, 90);
            if (kind === 'rect') {
                el.setAttribute('width', '6');
                el.setAttribute('height', '10');
                el.setAttribute('rx', '1');
                el.setAttribute('x', String(x));
                el.setAttribute('y', String(y));
            } else {
                el.setAttribute('r', String(rand(2, 5)));
                el.setAttribute('cx', String(x));
                el.setAttribute('cy', String(y));
            }
            el.setAttribute('fill', 'hsl(' + rand(10, 320) + ', ' + rand(70, 90) + '%, ' + rand(45, 65) + '%)');
            el.setAttribute('class', 'conf');
            el.style.opacity = '1';
            confettiGroup.appendChild(el);
            (function(el) {
                setTimeout(function() {
                    var dx = rand(-160, 160);
                    var dy = rand(80, 220);
                    el.style.transform = 'translate(' + dx + 'px, ' + dy + 'px) rotate(' + rand(-360, 360) + 'deg) scale(' + rand(0.4, 1) + ')';
                    el.style.opacity = '0';
                }, rand(20, 220));
            })(el);
        }
        setTimeout(function() {
            confettiGroup.innerHTML = '';
        }, 1200);
    }
    if (range) range.addEventListener('input', function() {
        var n = Math.max(1, Math.min(12, Number(range.value)));
        if (label) label.textContent = String(n);
        renderCandles(n);
    });
    if (incBtn) incBtn.addEventListener('click', function() {
        var n = Math.min(12, candleCount + 1);
        renderCandles(n);
    });
    if (decBtn) decBtn.addEventListener('click', function() {
        var n = Math.max(1, candleCount - 1);
        renderCandles(n);
    });
    if (blowBtn) blowBtn.addEventListener('click', blowOutAll);
    if (relightAllBtn) relightAllBtn.addEventListener('click', relightAll);
    if (makeAWishBtn) makeAWishBtn.addEventListener('click', function() {
        if (!candlesOn.some(Boolean)) {
            var mid = Math.floor(candlesOn.length / 2);
            toggleCandle(mid, true);
        }
        spawnConfetti(30);
    });
    if (cakeWrap) cakeWrap.addEventListener('click', function() {
        var mid = Math.floor(candlesOn.length / 2);
        toggleCandle(mid);
    });
    document.addEventListener('keydown', function(ev) {
        if ((ev.code === 'Space' || ev.key === ' ') && (document.activeElement === document.body || document.activeElement === cakeWrap)) {
            ev.preventDefault();
            var mid = Math.floor(candlesOn.length / 2);
            toggleCandle(mid);
        }
    });
    renderCandles(candleCount);
})();

</script>


  <script>// Small helper script to show the "Make a Wish" popup when the Make a wish button is clicked.
(function() {
    const makeBtn = document.getElementById('makeAWish');
    const popup = document.getElementById('wishPopup');
    const closeBtn = document.getElementById('closeWish');
    const wishMsg = document.getElementById('wishMsg');
    if (!makeBtn || !popup || !closeBtn) return;
    function openPopup(message, autoHideMs = 4000) {
        if (message) wishMsg.textContent = message;
        popup.classList.add('show');
        popup.setAttribute('aria-hidden', 'false');
        // Auto-hide after a while (if desired)
        if (autoHideMs && autoHideMs > 0) {
            clearTimeout(popup._autoHideTimer);
            popup._autoHideTimer = setTimeout(closePopup, autoHideMs);
        }
    }
    function closePopup() {
        popup.classList.remove('show');
        popup.setAttribute('aria-hidden', 'true');
        if (popup._autoHideTimer) {
            clearTimeout(popup._autoHideTimer);
            popup._autoHideTimer = null;
        }
    }
    // wire to click: we still let cake.ts spawn confetti etc; this just shows the wish
    makeBtn.addEventListener('click', (ev)=>{
        // message can be customized or randomized
        const messages = [
            "May all your wishes come true, my love \uD83D\uDC96",
            "Wishing you every happiness today and always \u2728",
            "Make a wish \u2014 I will hold it in my heart for you \uD83D\uDC97"
        ];
        const msg = messages[Math.floor(Math.random() * messages.length)];
        openPopup(msg, 4500);
    });
    // close handlers
    closeBtn.addEventListener('click', closePopup);
    popup.addEventListener('click', (e)=>{
        // clicking backdrop closes
        if (e.target === popup) closePopup();
    });
    document.addEventListener('keydown', (e)=>{
        if (e.key === 'Escape' && popup.classList.contains('show')) closePopup();
    });
    // make popup accessible: focus management
    makeBtn.addEventListener('click', ()=>{
        // small timeout so that button click handlers in cake.ts run first
        setTimeout(()=>{
            closeBtn.focus();
        }, 100);
    });
})();

</script>

<script src="/cake.0834ede4.js"></script></body></html>